<!-- XHTML 1.0 Strict -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<meta name="author" content="Rachid Touzani" />
<meta name="keywords" content=" css, dropdowns, dropdown menu, drop-down, menu, navigation, nav, horizontal, vertical left-to-right, vertical right-to-left, horizontal linear, horizontal upwards, cross browser, internet explorer, ie, firefox, safari, opera, browser, lwis" />
<meta name="description" content="Clean, standards-friendly, modular framework for dropdown menus" />
<link href="../css/dropdown.vertical.css" media="screen" rel="stylesheet" type="text/css" />
<link href="../css/default.ultimate.css" media="screen" rel="stylesheet" type="text/css" />

<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<title>Lesson 1</title>
<link rel="stylesheet" type="text/css" href="../doxygen.css" />
<link rel="stylesheet" type="text/css" href="../tabs.css"  />
</head>

<body bgcolor="#FFFFFF" link="#FF0000" vlink="#FF00FF" alink="#FF00FF">
<p align="center"><a href="../index.html"><img src="../im/ofeli.gif" width="150" border="0"></a></p>

<center>
  <div id="cse" style="width: 60%;">Loading</div>
  <script src="http://www.google.com/jsapi" type="text/javascript"></script>
  <script type="text/javascript"> 
     google.load('search', '1', {language : 'en', style : google.loader.themes.SHINY});
     google.setOnLoadCallback(function() {
        var customSearchOptions = {};  var customSearchControl = new google.search.CustomSearchControl(
        '012396140824982761142:-qrywxcfi_o', customSearchOptions);
        customSearchControl.setResultSetSize(google.search.Search.FILTERED_CSE_RESULTSET);
        customSearchControl.draw('cse');
     }, true);
   </script>
   <style type="text/css">
     .gsc-control-cse {
     font-family: Verdana, sans-serif;
     border-color: #DAE0E5;
     background-color: #DAE0E5;
   }
   .gsc-control-cse .gsc-table-result { font-family: Verdana, sans-serif; }
   input.gsc-input { border-color: #B6BEC5; }
   input.gsc-search-button {
     border-color: #B6BEC5;
     background-color: #D0D1D4;
   }
   .gsc-tabHeader.gsc-tabhInactive {
     border-color: #999999;
     background-color: #EEEEEE;
   }
   .gsc-tabHeader.gsc-tabhActive {
     border-color: #999999;
     background-color: #999999;
   }
   .gsc-tabsArea { border-color: #999999; }
   .gsc-webResult.gsc-result,
   .gsc-results .gsc-imageResult {
     border-color: #FFFFFF;
     background-color: #FFFFFF;
   }
   .gsc-webResult.gsc-result:hover,
   .gsc-imageResult:hover {
     border-color: #D2D6DC;
     background-color: #EDEDED;
   }
   .gsc-webResult.gsc-result.gsc-promotion:hover {
     border-color: #D2D6DC;
     background-color: #EDEDED;
   }
   .gs-webResult.gs-result a.gs-title:link,
   .gs-webResult.gs-result a.gs-title:link b,
   .gs-imageResult a.gs-title:link,
   .gs-imageResult a.gs-title:link b { color: #0568CD; }
   .gs-webResult.gs-result a.gs-title:visited,
   .gs-webResult.gs-result a.gs-title:visited b,
   .gs-imageResult a.gs-title:visited,
   .gs-imageResult a.gs-title:visited b { color: #0568CD; }
   .gs-webResult.gs-result a.gs-title:hover,
   .gs-webResult.gs-result a.gs-title:hover b,
   .gs-imageResult a.gs-title:hover,
   .gs-imageResult a.gs-title:hover b { color: #0568CD; }
   .gs-webResult.gs-result a.gs-title:active,
   .gs-webResult.gs-result a.gs-title:active b,
   .gs-imageResult a.gs-title:active,
   .gs-imageResult a.gs-title:active b { color: #0568CD; }
   .gsc-cursor-page { color: #0568CD; }
   a.gsc-trailing-more-results:link { color: #0568CD; }
   .gs-webResult .gs-snippet,
   .gs-imageResult .gs-snippet,
   .gs-fileFormatType { color: #5F6A73; }
   .gs-webResult div.gs-visibleUrl,
   .gs-imageResult div.gs-visibleUrl { color: #5F6A73; }
   .gs-webResult div.gs-visibleUrl-short { color: #5F6A73; }
   .gs-webResult div.gs-visibleUrl-short { display: none; }
   .gs-webResult div.gs-visibleUrl-long { display: block; }
   .gs-promotion div.gs-visibleUrl-short { display: none; }
   .gs-promotion div.gs-visibleUrl-long { display: block; }
   .gsc-cursor-box { border-color: #FFFFFF; }
   .gsc-results .gsc-cursor-box .gsc-cursor-page {
      border-color: #999999;
      background-color: #FFFFFF;
      color: #0568CD;
   }
   .gsc-results .gsc-cursor-box .gsc-cursor-current-page {
      border-color: #999999;
      background-color: #999999;
      color: #0568CD;
   }
   .gsc-webResult.gsc-result.gsc-promotion {
      border-color: #D2D6DC;
      background-color: #D0D1D4;
   }
   .gsc-completion-title { color: #0568CD; }
   .gsc-completion-snippet { color: #5F6A73; }
   .gs-promotion a.gs-title:link,
   .gs-promotion a.gs-title:link *,
   .gs-promotion .gs-snippet a:link { color: #0066CC; }
   .gs-promotion a.gs-title:visited,
   .gs-promotion a.gs-title:visited *,
   .gs-promotion .gs-snippet a:visited { color: #0066CC; }
   .gs-promotion a.gs-title:hover,
   .gs-promotion a.gs-title:hover *,
   .gs-promotion .gs-snippet a:hover { color: #0066CC; }
   .gs-promotion a.gs-title:active,
   .gs-promotion a.gs-title:active *,
   .gs-promotion .gs-snippet a:active { color: #0066CC; }
   .gs-promotion .gs-snippet,
   .gs-promotion .gs-title .gs-promotion-title-right,
   .gs-promotion .gs-title .gs-promotion-title-right *  { color: #333333; }
   .gs-promotion .gs-visibleUrl,
   .gs-promotion .gs-visibleUrl-short { color: #5F6A73; }
   </style>
</center>
</p>

<div id="mainmenu">
<div class="text">

 <div class="tabs">
   <ul class="tablist">
   <li><a href="../index.html"><span>Home</span></a>
   <li><a href="../overview.html"><span>Overview</span></a>
   <li><a href="../html/index.html"><span>Class Documentation</span></a>
   <li><a href="../fformats.html"><span>File Formats</span></a>
   <li class="current"><a href="../tutorial.html"><span>Tutorial</span></a>
   <li><a href="../demos.html"><span>Demo Codes</span></a>
   </ul>
 </div>

 </div>
 </div>

&nbsp;
<p>
<h2>Lesson 1: A 1-D problem</h2>

<p><table border="2" cellpadding="2" cellspacing="0" >
<tr>
<td align="center" width="35"><a href="../tutorial.html"><img src="../im/top.gif" border="0"></a></td>
<td align="center" width="35"><a href="lesson2.html"><img src="../im/forward.gif" border="0"></a></td>
</tr>
</table>

<p>
<SPAN class=TEXT>This lesson concerns a simple one-dimensional two-point boundary value problem.
The whole program can be found in Example 1 in the <span class=VAR>examples</span> directory. We will examine it
here below line by line.
</SPAN>

<ul type="square">
<li><SPAN class=TEXT>We start by including the header file <span class=TT>OFELI.h</span> that itself includes all kernel
class definitions.</span><br>
<p><table bgcolor="#e0f8f7" border="1" frame=box rules=none width=700>
<tr><td>
<pre><font color="blue" size=3>   #include "OFELI.h" </font></pre>
</td></tr></table></p>
<li><SPAN class=TEXT>The <span class="LOGO">OFELI</span> library is embedded in  namespace called
<span class=TT>OFELI</span>.</span><br>
<p><table bgcolor="#e0f8f7" border="1" frame=box rules=none width=700>
<tr><td>
<pre><font color="blue" size=3>   using namespace OFELI;</font></pre>
</td></tr></table></p>
<li><SPAN class=TEXT>Our program has arguments that will described later.</span><br>
<p><table bgcolor="#e0f8f7" border="1" frame=box rules=none width=700>
<tr><td>
<pre><font color="blue" size=3>   int main(int argc, char *argv[])
   {</font></pre>
</td></tr></table></p>
<li><SPAN class=TEXT><span class=TT>L</span> is the length
of the interval in which the problem is defined. Here we have fixed their respective values
at <span class=TT>0</span> and <span class=TT>1</span>.
<span class=TT>N</span> is the number of finite elements. Its default value is <span class=TT>10</span></span></br>
<p><table bgcolor="#e0f8f7" border="1" frame=box rules=none width=700>
<tr><td>
<pre><font color="blue" size=3>      double L=1;
      int N=10;</font></pre>
</td></tr></table></p>
<li><SPAN class=TEXT>The <span class="logo">OFELI</span> function <span class=TT>banner</span>
outputs the official banner of the library.</span></br>
<p><table bgcolor="#e0f8f7" border="1" frame=box rules=none width=700>
<tr><td>
<pre><font color="blue" size=3>      banner();</font></pre>
</td></tr></table></p>
<li><SPAN class=TEXT><span class=TT>N</span> is the program argument (if this one is present)</span>
<p><table bgcolor="#e0f8f7" border="1" frame=box rules=none width=700>
<tr><td>
<pre><font color="blue" size=3>   if (argc > 1)
      N = atoi(argv[1]);</font></pre>
</td></tr></table></p>
<li><SPAN class=TEXT>We now declare an instance of class <span class=var><a href="../html/classOFELI_1_1Mesh.html">Mesh</a></span>
with the appropriate constructor.</span>
<p><table bgcolor="#e0f8f7" border="1" frame=box rules=none width=700>
<tr><td>
<pre><font color="blue" size=3>   Mesh ms(L,N);</font></pre>
</td></tr></table></p>
<li><SPAN class=text>We denote by <span class=TT>NbN</span> the number of unknowns, the solution
being prescribed at <span class=TT>x=0</span> and then we print out the mesh. Note that member function
<span class=TT>setVerbose</span> with a large value for argument enables printing the whole mesh information.</span>
<p><table bgcolor="#e0f8f7" border="1" frame=box rules=none width=700>
<tr><td>
<pre><font color="blue" size=3>   int NbN = N+1;
   ms.setVerbose(10);
   cout &lt;&lt; ms;</font></pre>
</td></tr></table></p>
<li><SPAN class=TEXT>We declare an instance of class <span class=var><a href="../html/classOFELI_1_1TrMatrix.html">TrMatrix&lt;double&gt;</a></span>
for the tridiagonal matrix, with size <span class=TT>NbN</span> and an instance of class
<span class=TT><a href="../html/classOFELI_1_1Vect.html">Vect&lt;double&gt;</a></span>
for the right-hand side and the solution. Note that the vector
constructor uses here the mesh instance. This simplifies the use of
algebraic expressions for vector assignments.</span>
<p><table bgcolor="#e0f8f7" border="1" frame=box rules=none width=700>
<tr><td>
<pre><font color="blue" size=3>   TrMatrix&lt;double&gt; A(NbN);
   Vect&lt;double&gt; b(ms);
</td></tr></table></p>
<li><SPAN class=TEXT>In order to test the code, we choose an exact
solution: We set for right-hand side the function <span
class=TT>f(x) = 16&pi;<sup>2</sup>sin(4&pi;x)</span> and the boundary conditions <span
class=TT>u(0) = u(1) = 0</span>.
This yields the solution
<span class=TT>u(x) = sin(4&pi;x)</span>.
To implement this without implementing additional functions we resort
to the <span class=LOGO>OFELI</span>'s parser. For this, the member
function <span class=TT>set</span> of class
<span class=TT><a href="../html/classOFELI_1_1Vect.html">Vect&lt;double&gt;</a></span>
enables assigning regular expressions to nodes in function of their
coordinates. The variables are <span class=TT>x</span>, <span
class=TT>y</span>
and <span class=TT>z</span>.</span>
<p><table bgcolor="#e0f8f7" border="1" frame=box rules=none width=700>
<tr><td>
<pre><font color="blue" size=3>   b.set("16*pi*pi*sin(4*pi*x)");</font></pre>
</td></tr></table></p>
<li><SPAN class=TEXT><span class=TT>h</span> is the mesh size (length
of an element).
We can compute the right-hand side of the linear system by multiplying
it by the mesh size.</span>
<p><table bgcolor="#e0f8f7" border="1" frame=box rules=none width=700>
<tr><td>
<pre><font color="blue" size=3>   double h = L/double(N);
   b *= h;</font></pre>
</td></tr></table></p>
<li><SPAN class=TEXT>We now build up the matrix and the right-hand side. Note that we skip, for the
moment, the first and the last lines for boundary condition treatment. Here <span class=TT>x</span>
is the <span class=TT>i</span>-th node coordinate.</span>
<p><table bgcolor="#e0f8f7" border="1" frame=box rules=none width=700>
<tr><td>
<pre><font color="blue" size=3>   for (int i=2; i&lt;NbN; i++) {
      A(i,i  ) =  2./h;
      A(i,i+1) = -1./h;
      A(i,i-1) = -1./h;
  }</font></pre>
</td></tr></table></p>
<li><SPAN class=TEXT>We modify the first and last equation in order to take account for boundary conditions.</span>
<p><table bgcolor="#e0f8f7" border="1" frame=box rules=none width=700>
<tr><td>
<pre><font color="blue" size=3>   A(1,1) = 1.; A(1,2) = 0.; b(1) = 0;
   A(NbN,NbN) = 1.; A(NbN-1,NbN) = 0.; b(NbN) = 0;</font></pre>
</td></tr></table></p>
<li><SPAN class=TEXT>The linear system is solved.</span>
<p><table bgcolor="#e0f8f7" border="1" frame=box rules=none width=700>
<tr><td>
<pre><font color="blue" size=3>   A.solve(b);</font></pre>
</td></tr></table></p>
<li><SPAN class=TEXT>We finally output the solution, calculate the
error at each node and output it.
Note that the exact solution vector use also the parser.</span>
<p><table bgcolor="#e0f8f7" border="1" frame=box rules=none width=700>
<tr><td>
<pre><font color="blue" size=3>   cout &lt;&lt; "\nSolution :\n"&lt;&lt; b;
   Vect&lt;double&gt; sol(ms);
   sol.set("sin(4*pi*x)");
   cout &lt;&lt; "Error = " &lt;&lt; (b-sol).getNormMax() &lt;&lt; endl;</font></pre>
</td></tr></table></p>
<li><SPAN class=TEXT>We now end the program.</span>
<p><table bgcolor="#e0f8f7" border="1" frame=box rules=none width=700>
<tr><td>
<pre><font color="blue" size=3>   return 0;
}</font></pre>
</td></tr></table></p>
<li><SPAN class=TEXT>If you execute the program without any argument,
you will obtain as output :</span>
<pre><font color="#800080" size=3>
M E S H     D A T A
===================

Space Dimension        :      1
Number of nodes        :     11
Number of elements     :     10
Number of sides        :      0


Solution :
     1       0.00000000e+00
     2       1.08674760e+00
     3       6.71646957e-01
     4      -6.71646957e-01
     5      -1.08674760e+00
     6      -1.62832710e-15
     7       1.08674760e+00
     8       6.71646957e-01
     9      -6.71646957e-01
    10      -1.08674760e+00
    11       0.00000000e+00
	
Error = 1.35691088e-01
</font></pre>
</ul>

<p><table align="center" border="2" cellpadding="2" cellspacing="0" >
<tr>
<td align="center" width="35"><a href="../tutorial.html"><img src="../im/top.gif" border="0"></a></td>
<td align="center" width="35"><a href="lesson2.html"><img src="../im/forward.gif" border="0"></a></td>
</tr>
</table>

&nbsp;
<div id="foot_bar">
        Copyright &copy; 1998-2018 Rachid Touzani&nbsp;
</div>

</body>
</html>
